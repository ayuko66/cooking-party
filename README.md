# Cooking Party (クッキングパーティー)

みんなで材料を出し合い、AIシェフに「架空の料理」と「イラスト」を作ってもらうパーティーゲームです。

## 概要
- **プレイ人数**: 最大5人（最初に参加した人がホスト）
- **所要時間**: 1ラウンド 約1分
- **必要なもの**: ブラウザ（PC/スマホ）

## ゲームルール
- 部屋IDは4桁英数字（大文字）を新規作成時に払い出し、URLで共有。
- 材料入力フェーズは30秒。ホストが「ゲームスタート！」を押すとカウントダウン開始。
- 材料は合計20個まで、1件10文字以内（サーバ側で検証。入力欄は20文字だが10文字が上限）。
- カウントダウンが0になるとホスト端末が自動でクッキングを開始し、COOKING→RESULTへ遷移。
- テキスト生成：Groq（Llama 3.3 70B）。画像生成：Google Gemini 2.5 Flash Image。失敗時はフォールバックの料理名・画像で続行。

## 遊び方
1. **部屋を作る**: トップページで「新しい部屋を作る」を押すと部屋IDが発行され、部屋画面へ移動。
2. **参加する**: 表示されたURLを友だちに共有し、ニックネームを入力して参加（先着5人）。
3. **待機**: ホストには「ゲームスタート！」ボタンが表示される。全員集合したら押す。
4. **材料入力**: 30秒以内に思いついた材料を送信（10文字以内・合計20件まで）。
5. **調理**: タイマーが0になるとAIシェフが材料から料理を生成。
6. **完成**: 料理名、説明、イラスト、使用材料が発表される。「もう一度遊ぶ」でトップへ。

## デモ / 開発モード（APIコスト削減用）
- URLに `?dev=true` または `?dec=true` を付けてアクセスすると有効化。sessionStorageに保存され、タブを閉じるまで継続。
- 画面右下に「DEVモード中」バッジを表示。
- `/api/rooms/cook` に `isDev: true` を渡し、AI呼び出しをスキップして固定レスポンス（デバッグカレーDX）を保存。

## 技術スタック
- **フレームワーク**: Next.js (App Router)
- **スタイリング**: Tailwind CSS
- **AI**:
  - テキスト生成: Groq API (Llama 3.3 70B)
  - 画像生成: Google Gemini 2.5 Flash Image (Nano Banana)
- **インフラ**: Docker

## 環境変数
- `GROQ_API_KEY` … テキスト生成用（必須）
- `GOOGLE_API_KEY` … 画像生成用（必須）
- `REDIS_URL` … Vercel/本番では必須。未設定かつローカルではメモリストアにフォールバック。
- `ROOM_TTL_SECONDS` … 部屋データのTTL（省略時6時間）

## 起動方法（開発）
1. リポジトリをクローンする。
2. `.env` を作成し、APIキー（必要なら `REDIS_URL` も）を設定する。
   ```env
   GROQ_API_KEY=your_groq_api_key
   GOOGLE_API_KEY=your_google_api_key
   # REDIS_URL=redis://localhost:6379
   ```
3. Docker Compose で起動する。
   ```bash
   docker-compose up --build
   ```
4. ブラウザで `http://localhost:3000` にアクセスする。
5. （任意）`http://localhost:3000/?dev=true` にアクセスするとAI呼び出しなしで動作確認できる。
